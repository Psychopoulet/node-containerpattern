"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _isPlainObject(t){return t&&"object"==(void 0===t?"undefined":_typeof(t))&&Object==t.constructor}function _isArray(t){return t&&"object"==(void 0===t?"undefined":_typeof(t))&&t instanceof Array}function _checkData(t,e,o){if(void 0===o)throw new ReferenceError('The "'+e+'" value is undefined');if(t.limits[e]&&-1>=t.limits[e].indexOf(o))throw new Error('The "'+e+'" data does not correspond to the limits ('+JSON.stringify(t.limits[e])+")");if(t.skeletons[e])if("object"===t.skeletons[e]){if(!_isPlainObject(o)){if("string"!=typeof o)throw new TypeError('The "'+e+'" data does not correspond to the skeleton');if("{"!==o[0]||"}"!==o[o.length-1])throw new TypeError('The "'+e+'" data does not correspond to the skeleton');o=JSON.parse(o)}}else if("array"===t.skeletons[e]){if(!_isArray(o)){if("string"!=typeof o)throw new TypeError('The "'+e+'" data does not correspond to the skeleton');if("["!==o[0]||"]"!==o[o.length-1])throw new TypeError('The "'+e+'" data does not correspond to the skeleton');o=JSON.parse(o)}}else if(-1<["boolean","email","float","integer","ipv4","ipv6","number","string"].indexOf(t.skeletons[e])&&t.skeletons[e]!==(void 0===o?"undefined":_typeof(o)))switch(t.skeletons[e]){case"string":o+="";break;case"email":if("string"!=typeof o)throw new TypeError('The "'+e+'" data does not correspond to the skeleton');if(""!==o&&!EMAIL_PATTERN.test(o))throw new TypeError('The "'+e+'" data does not correspond to the skeleton');break;case"ipv4":if("string"!=typeof o)throw new TypeError('The "'+e+'" data does not correspond to the skeleton');if(""!==o&&!IPV4_PATTERN.test(o))throw new TypeError('The "'+e+'" data does not correspond to the skeleton');break;case"ipv6":if("string"!=typeof o)throw new TypeError('The "'+e+'" data does not correspond to the skeleton');if(""!==o&&!IPV6_PATTERN.test(o))throw new TypeError('The "'+e+'" data does not correspond to the skeleton');break;case"boolean":o="true"===o||"yes"===o||"y"===o||"1"===o||1===o||!0===o;break;case"float":case"number":if(isNaN(parseFloat(o)))throw new TypeError('The "'+e+'" data does not correspond to the skeleton');o=parseFloat(o);break;case"integer":if(isNaN(parseInt(o)))throw new TypeError('The "'+e+'" data does not correspond to the skeleton');o=parseInt(o)}return o}function _checkDataRecursive(t,e,o){for(var r in o)o[r]=_checkData(t,e+t.recursionSeparator+r,o[r]),_isPlainObject(o[r])&&(o[r]=_checkDataRecursive(t,e+t.recursionSeparator+r,o[r]));return o}function _createBaseObject(t,e,o,r,n,a){return o=_checkData(t,e,o),n<r.length-1?o[r[n]]=_createBaseObject(t,e+t.recursionSeparator+r[n],o[r[n]]?o[r[n]]:{},r,n+1,a):o[r[n]]=_checkData(t,e+t.recursionSeparator+r[n],a),o}function _extractDocumentation(t,e,o){var r={};if(_isPlainObject(o))for(var n in o){var a=o[n],i=""!==e?e+t.recursionSeparator+n:n,s=t.documentations[i]?t.documentations[i]:"";"object"===(void 0===a?"undefined":_typeof(a))?(r[n]={fullkey:i,documentation:s},_isArray(a)?(r[n].type="array",r[n].content=0===a.length?[]:a):(r[n].type="object",r[n].content=0===Object.keys(a).length?{}:_extractDocumentation(t,i,a))):"number"==typeof a?Number.isInteger(a)?r[n]={fullkey:i,type:"integer",documentation:s}:r[n]={fullkey:i,type:"float",documentation:s}:r[n]={fullkey:i,type:void 0===a?"undefined":_typeof(a),documentation:s}}else(t===o||_isArray(o))&&o.forEach(function(o,n){var a=""!==e?e+t.recursionSeparator+n:n,i=t.documentations[a]?t.documentations[a]:"";"object"===(void 0===o?"undefined":_typeof(o))?(r[n]={fullkey:a,documentation:i},_isArray(o)?(r[n].type="array",r[n].content=0===o.length?[]:o):(r[n].type="object",r[n].content=0===Object.keys(o).length?{}:_extractDocumentation(t,a,o))):"number"==typeof o?Number.isInteger(o)?r[n]={fullkey:a,type:"integer",documentation:i}:r[n]={fullkey:a,type:"float",documentation:i}:r[n]={fullkey:a,type:void 0===o?"undefined":_typeof(o),documentation:i}});return r}function _formateKey(t){if(void 0===t)throw new ReferenceError("The key does not exist");if("string"!=typeof t)throw new TypeError("The key is not a string");if(""===(t=t.trim()))throw new Error("The key is empty");return t}var _createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),e}}(),_get=function t(e,o,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,o);if(void 0===n){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,o,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},EMAIL_PATTERN=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,IPV4_PATTERN=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,IPV6_PATTERN=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;module.exports=function(t){function e(t){_classCallCheck(this,e);var o=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.documentations={},o.limits={},o.recursionSeparator="string"==typeof t?t:".",o.skeletons={},o}return _inherits(e,t),_createClass(e,[{key:"skeleton",value:function(t,e){if(t=_formateKey(t),void 0===e)throw new ReferenceError('The "'+t+'" data has not any "skeleton" attribute');if("string"!=typeof e)throw new TypeError('The "'+t+'" data has an invalid "skeleton" attribute');if(e=e.trim().toLowerCase(),-1>=["array","boolean","email","float","integer","ipv4","ipv6","number","object","string"].indexOf(e))throw new TypeError('The "'+t+'" data has an invalid "skeleton" attribute');return this.skeletons[t]=e,this}},{key:"clear",value:function(){return this.clearData().clearDocumentations().clearLimits().clearSkeletons()}},{key:"clearData",value:function(){return _get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clear",this).call(this),this}},{key:"clearDocumentations",value:function(){return this.documentations={},this}},{key:"clearLimits",value:function(){return this.limits={},this}},{key:"clearSkeletons",value:function(){return this.skeletons={},this}},{key:"delete",value:function(t){return _get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"delete",this).call(this,_formateKey(t)),this}},{key:"document",value:function(t,e){if(t=_formateKey(t),void 0===e)throw new ReferenceError('The "'+t+'" data has not any "documentation" attribute');if("string"!=typeof e)throw new TypeError('The "'+t+'" data has an invalid "documentation" attribute');return this.documentations[t]=e,this}},{key:"documentation",value:function(){return _extractDocumentation(this,"",this)}},{key:"get",value:function(t){if(t=_formateKey(t),this.has(t)){if(-1<t.indexOf(this.recursionSeparator)){for(var o=t.split(this.recursionSeparator),r=this.get(o[0]),n=1;n<o.length;++n)r=r[o[n]];return r}return _get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"get",this).call(this,t)}throw new Error('Unknown key "'+t+'"')}},{key:"has",value:function(t){if(t=_formateKey(t),-1>=t.indexOf(this.recursionSeparator))return _get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"has",this).call(this,t);var o=t.split(this.recursionSeparator);if(_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"has",this).call(this,o[0])){for(var r=!1,n=1,a=_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"get",this).call(this,o[0]);n<o.length&&("object"===(void 0===a?"undefined":_typeof(a))&&void 0!==a[o[n]]);++n){if(n===o.length-1){r=!0;break}a=a[o[n]]}return r}return!1}},{key:"limit",value:function(t,e){if(t=_formateKey(t),void 0===e)throw new ReferenceError('The "'+t+'" data has not any "limit" attribute');if(!_isArray(e))throw new TypeError('The "'+t+'" data has an invalid "limit" attribute');return this.limits[t]=e,this}},{key:"set",value:function(t,o){if(t=_formateKey(t),o=_checkData(this,t,o),-1<t.indexOf(this.recursionSeparator)){var r=t.split(this.recursionSeparator);if(!_isPlainObject(o)||1>Object.keys(o).length){var n=r.shift();_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,n,_createBaseObject(this,n,_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"has",this).call(this,n)?_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"get",this).call(this,n):{},r,0,o))}else{var a=r.shift();_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,a,_createBaseObject(this,a,_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"has",this).call(this,a)?_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"get",this).call(this,a):{},r,0,_checkDataRecursive(this,t,o)))}}else _isPlainObject(o)?1>Object.keys(o).length?_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t,{}):_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t,_checkDataRecursive(this,t,o)):_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"set",this).call(this,t,o);return this}}]),e}(Map);